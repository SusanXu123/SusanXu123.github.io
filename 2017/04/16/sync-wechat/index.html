<!DOCTYPE html><html><head><meta charset="UTF-8"><title>起一个服务进行两个不同的微信公众号之间的素材迁移</title><link rel="stylesheet" href="http://obfnm2kw5.bkt.clouddn.com/normalize.css"><link rel="stylesheet" href="/css/hexo-theme-adoubi.css"><link rel="icon" href="/images/favicon.ico"></head><body><div class="header"><div class="header__title"><a href="/"><figure class="header__title__image"></figure></a></div><div class="header__archive"><a href="/archives"><figure class="header__archive__image"></figure><span class="header__archive__title">archive</span></a></div><div class="header__about"><a href="/about"><figure class="header__about__image"></figure><span class="header__about__title">about</span></a></div><div class="header__github"><a href="https://github.com/shinux" target="_blank"><figure class="header__github__image"></figure><span class="header__github__title">github</span></a></div><div class="header__feed"><a href="/atom.xml"><figure class="header__feed__image"></figure><span class="header__feed__title">feed</span></a></div><div class="header__notes"></div></div><div class="content"><div class="post-item"></div><h2 class="post-title-wrapper"><p class="post-title">起一个服务进行两个不同的微信公众号之间的素材迁移</p></h2><div class="post-date"><time datetime="2017-04-16T05:04:40.000Z">2017-04-16</time></div><div class="post-content"><h3 id="1-所需依赖"><a href="#1-所需依赖" class="headerlink" title="1. 所需依赖"></a>1. 所需依赖</h3><ul>
<li><p>redis  </p>
<p>文档：<a href="http://redis.js.org/#api-connection-and-other-events-ready" target="_blank" rel="external">http://redis.js.org/#api-connection-and-other-events-ready</a></p>
<p>官网：<a href="https://redis.io/" target="_blank" rel="external">https://redis.io/</a> </p>
<p>是一个由Salvatore Sanfilippo写的key-value存储系统。在项目中用于缓存access-token</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install redis</div></pre></td></tr></table></figure>
</li>
<li><p>bluebird</p>
<p>方法 promise 化</p>
<p><a href="https://github.com/petkaantonov/bluebird" target="_blank" rel="external">https://github.com/petkaantonov/bluebird</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install bluebird</div></pre></td></tr></table></figure>
</li>
<li><p>wechatApi</p>
<p>Wechat API/主动调用API，与微信后台官网的素材管理方法对应</p>
<p><a href="https://github.com/node-webot/wechat-api" target="_blank" rel="external">https://github.com/node-webot/wechat-api</a></p>
<p><a href="http://doxmate.cool/node-webot/wechat-api/api.html#api_material_exports_getMaterial" target="_blank" rel="external">http://doxmate.cool/node-webot/wechat-api/api.html#api_material_exports_getMaterial</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install wechat-api</div></pre></td></tr></table></figure>
</li>
<li><p>disposition</p>
<p>获取相应头部信息</p>
<p><a href="https://github.com/jshttp/content-disposition" target="_blank" rel="external">https://github.com/jshttp/content-disposition</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install content-disposition</div></pre></td></tr></table></figure>
</li>
<li><p>express</p>
<p>基于 <a href="http://nodejs.org/" target="_blank" rel="external">Node.js</a>  的Web开发框架，在该项目中用于起服务器</p>
<p><a href="https://github.com/expressjs/express" target="_blank" rel="external">https://github.com/expressjs/express</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm i express</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
<h3 id="2-编程逻辑设计"><a href="#2-编程逻辑设计" class="headerlink" title="2.编程逻辑设计"></a>2.编程逻辑设计</h3><ol>
<li>用redis缓存access-token</li>
<li>用WeChat-api初始化两个实例：sourceWechat, tragetWechat </li>
<li>用Wechat-api下载sourceWechat的素材 &gt;</li>
<li>将下载的素材保存到本地cache 文件夹中</li>
<li>将保存的文件用Wechat-api 上传到 tragetWechat，并把本地文件删除</li>
</ol>
<h3 id="3-具体实现"><a href="#3-具体实现" class="headerlink" title="3.具体实现"></a>3.具体实现</h3></div></div><div class="footer"><div class="footer-copyright">Theme By <a href="https://github.com/shinux/hexo-theme-adoubi">Adoubi</a> , Powered By Hexo.</div></div></body></html>